{"version":3,"file":"Panel-C3cLuuM2.js","sources":["../../src/vue/src/components/Kontrol/Panel.vue"],"sourcesContent":["<docs>\n# KontrolPanel\n> A Tweakpane Control Panel to help by exposing and updating specific properties during the dev env\n\n@author Guillaume Tomasi <guillaume@kffein.com>\n</docs>\n\n<script lang=\"ts\" setup>\nimport { tryOnUnmounted } from '@vueuse/core';\nimport { storeToRefs } from 'pinia';\nimport usePageFlow from 'utils/flow/page';\nimport { ref, watch } from 'vue';\nimport config from \"./config\";\nimport { store as kontrolStore } from \"./store\";\n\n//---- Vars\nconst { onInitUi } = usePageFlow<any>();\n\nconst lightboxExport = ref<any>()\nconst lightboxImport = ref<any>()\nconst CodeImport = ref<any>()\nconst Code = ref<any>();\n\nconst {\n  position,\n  visible,\n  size,\n  exportOutput,\n  importInput,\n} = storeToRefs(kontrolStore);\n\n\n//---- Lifecycle\n\n/**\n * Initialize the debug tool and the debug class\n */\nonInitUi( () => {\n\n  kontrolStore.init();\n  kontrolStore.addSystem();\n  kontrolStore.addUtils();\n\n  //keyboard shorcut\n  window.addEventListener(\"keydown\", onKeyDown);\n});\n\n/**\n* Clear the debug tool\n*/\ntryOnUnmounted( () => {\n  kontrolStore.dispose();\n\n  //keyboard shorcut\n  window.removeEventListener(\"keydown\", onKeyDown);\n});\n\n//---- Handlers\n\n/**\n * Keyboard Keydown\n * @param e KeyboardEvent \n */ \nconst onKeyDown = (e:KeyboardEvent) => {\n\n  const requiredKey = config.shiftKeyRequired ? e.shiftKey : true;\n\n  // show or hide\n  if(e.code === config.shortcuts.hide) {\n    kontrolStore.toggleVisible(!visible.value)\n  }\n  \n  //left or right\n  if((e.code === config.shortcuts.left || e.code === config.shortcuts.right) && requiredKey) {\n    kontrolStore.togglePosition(e.code)\n  }\n\n  //Bigger or smaller\n  if((e.code === config.shortcuts.bigger || e.code === config.shortcuts.smaller) && requiredKey) {\n    kontrolStore.changeSize(e.code === config.shortcuts.bigger)\n  }\n\n  //Select the right tab\n  if((e.code === config.shortcuts.focusRight || e.code === config.shortcuts.focusLeft) && requiredKey) {\n    kontrolStore.selectNextTab(e.code === config.shortcuts.focusRight ? 1 : -1)\n  }\n\n  // Save to Local Storage\n  if(e.code === config.shortcuts.save && requiredKey) {\n    kontrolStore.saveInStorage();\n  }\n\n  // Delete to Local Storage\n  if(e.code === config.shortcuts.delete && requiredKey) {\n    kontrolStore.clearStorage();\n  }\n\n  // Refresh from Local Storage\n  if(e.code === config.shortcuts.refresh && requiredKey) {\n    kontrolStore.getStorage();\n  }\n}\n\n/**\n * Lightbox closing\n */\nconst onClose = () => {\n  kontrolStore.clearImportExport();\n}\n\n/**\n * Import handler\n */\nconst onImport = () => {\n  kontrolStore.importData(CodeImport.value.value);\n  CodeImport.value.value = '';\n  lightboxImport.value.close();\n}\n\n/**\n * Clipboard copy handler\n */\nconst copyActiveCode = () => {\n  navigator.clipboard.writeText(Code.value.innerHTML);\n  lightboxExport.value.close();\n  alert(\"'Export copied to clipboard'\")\n}\n\n/**\n * Watch to open the export lightbox\n */\nwatch(\n  exportOutput,\n  (data) => {\n    if (data) lightboxExport.value.open();\n  },\n  {\n    deep:true\n  }\n)\n\n/**\n * Watch to open the import lightbox\n */\nwatch(\n  importInput,\n  (data) => {\n    if (data === '') lightboxImport.value.open();\n  },\n  {\n    deep:true\n  }\n)\n</script>\n\n<template>\n  <div id=\"kontrol\"\n       :data-position=\"position\"\n       :data-visible=\"visible\"\n       :data-underlightbox=\"exportOutput !== undefined || importInput !== undefined\"\n       :data-size=\"size\"\n  />\n  <ui-lightbox ref=\"lightboxExport\"\n               theme=\"standard\"\n               @close=\"onClose\"\n  >\n    <div class=\"wrapper-box\">\n      <div class=\"codewrapper\">\n        <p ref=\"Code\"\n           class=\"code\"\n           v-html=\"exportOutput\"\n        />\n        <ui-button label=\"COPY\"\n                   class=\"btn\"\n                   theme=\"reset\"\n                   @click=\"copyActiveCode\"\n        />\n      </div>\n    </div>\n  </ui-lightbox>\n  <ui-lightbox ref=\"lightboxImport\"\n               theme=\"standard\"\n               @close=\"onClose\"\n  >\n    <div class=\"wrapper-box\">\n      <div class=\"codewrapper\">\n        <textarea ref=\"CodeImport\"\n                  class=\"code -import\"\n        />\n        <ui-button label=\"IMPORT\"\n                   class=\"btn\"\n                   theme=\"reset\"\n                   @click=\"onImport\"\n        />\n      </div>\n    </div>\n  </ui-lightbox>\n</template>\n\n<style lang=\"stylus\" scoped>\n#kontrol\n  fixed top 0 right 0 left unset\n  z-index $z-debug\n  width 350px\n  padding 10px \n  trans(opacity)\n\n  &[data-underlightbox=\"true\"]\n    z-index $z-lightbox - 1\n\n  &[data-visible=\"false\"]\n    pointer-events none\n    opacity 0\n\n  &[data-position=\"left\"]\n    right unset\n    left 0\n\n  &[data-size=\"large\"]\n    width 700px\n    :deep() .tp-rotv\n      --bld-vw 350px\n\n\n  &[data-size=\"full\"]\n    width 100%\n    :deep() .tp-rotv\n      --bld-vw 50%\n\n.wrapper-box\n  absolute 0\n  padding 10px\n  f(row, $align:flex-start)\n\n  .btn\n    position fixed\n    height 30px\n    bottom 50px\n    left 50%\n    width 50%\n    padding 5px 10px\n    border 1px solid $c-main\n    background-color $c-main\n    text-align center\n    color $c-white\n    transform translateX(-50%)\n    trans();\n\n    &:hover, &[data-active=\"true\"]\n      background-color $c-white\n      border 1px solid $c-white\n      color $c-main\n\n  .codewrapper\n    position relative\n    f(column)\n    width 100%\n    height 100%\n    padding 0px 0px 0 0px\n    font-size 12px\n\n  .code\n    position relative\n    width 100%\n    height 100%\n    word-break break-word\n\n</style>\n"],"names":["onInitUi","usePageFlow","lightboxExport","ref","lightboxImport","CodeImport","Code","position","visible","size","exportOutput","importInput","storeToRefs","kontrolStore","onKeyDown","tryOnUnmounted","requiredKey","config","onClose","onImport","copyActiveCode","watch","data"],"mappings":"wlBAgBM,KAAA,CAAE,SAAAA,CAAS,EAAIC,EAAiB,EAEhCC,EAAiBC,EAAS,EAC1BC,EAAiBD,EAAS,EAC1BE,EAAaF,EAAS,EACtBG,EAAOH,EAAS,EAEhB,CACJ,SAAAI,EACA,QAAAC,EACA,KAAAC,EACA,aAAAC,EACA,YAAAC,CAAA,EACEC,EAAYC,CAAY,EAQ5Bb,EAAU,IAAM,CAEda,EAAa,KAAK,EAClBA,EAAa,UAAU,EACvBA,EAAa,SAAS,EAGf,OAAA,iBAAiB,UAAWC,CAAS,CAAA,CAC7C,EAKDC,EAAgB,IAAM,CACpBF,EAAa,QAAQ,EAGd,OAAA,oBAAoB,UAAWC,CAAS,CAAA,CAChD,EAQK,MAAAA,EAAa,GAAoB,CAErC,MAAME,EAAwC,EAAE,SAG7C,EAAE,OAASC,EAAO,UAAU,MAChBJ,EAAA,cAAc,CAACL,EAAQ,KAAK,GAIvC,EAAE,OAASS,EAAO,UAAU,MAAQ,EAAE,OAASA,EAAO,UAAU,QAAUD,GAC/DH,EAAA,eAAe,EAAE,IAAI,GAIhC,EAAE,OAASI,EAAO,UAAU,QAAU,EAAE,OAASA,EAAO,UAAU,UAAYD,GAChFH,EAAa,WAAW,EAAE,OAASI,EAAO,UAAU,MAAM,GAIxD,EAAE,OAASA,EAAO,UAAU,YAAc,EAAE,OAASA,EAAO,UAAU,YAAcD,GACtFH,EAAa,cAAc,EAAE,OAASI,EAAO,UAAU,WAAa,EAAI,EAAE,EAIzE,EAAE,OAASA,EAAO,UAAU,MAAQD,GACrCH,EAAa,cAAc,EAI1B,EAAE,OAASI,EAAO,UAAU,QAAUD,GACvCH,EAAa,aAAa,EAIzB,EAAE,OAASI,EAAO,UAAU,SAAWD,GACxCH,EAAa,WAAW,CAE5B,EAKMK,EAAU,IAAM,CACpBL,EAAa,kBAAkB,CACjC,EAKMM,EAAW,IAAM,CACRN,EAAA,WAAWR,EAAW,MAAM,KAAK,EAC9CA,EAAW,MAAM,MAAQ,GACzBD,EAAe,MAAM,MAAM,CAC7B,EAKMgB,EAAiB,IAAM,CAC3B,UAAU,UAAU,UAAUd,EAAK,MAAM,SAAS,EAClDJ,EAAe,MAAM,MAAM,EAC3B,MAAM,8BAA8B,CACtC,EAKA,OAAAmB,EACEX,EACCY,GAAS,CACJA,GAAqBpB,EAAA,MAAM,KAAK,CACtC,EACA,CACE,KAAK,EAAA,CAET,EAKAmB,EACEV,EACCW,GAAS,CACJA,IAAS,IAAmBlB,EAAA,MAAM,KAAK,CAC7C,EACA,CACE,KAAK,EAAA,CAET"}