const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-1hFz9eqi.js","assets/@debug-lodash-BIjirobg.js"])))=>i.map(i=>d[i]);
import{a as b,u as te,e as h,E as P,S as oe,b as q,_ as ne}from"./app-CKNy3kX0.js";import{d as ae,ay as F,b6 as ie,b9 as se,b4 as le,b5 as re,q as u,bQ as ue,W as de,l as R,p as V,aS as ce,o as d,Z as c,aT as X,_ as k,e as N,aU as W,g as C,b0 as _,$ as fe,b8 as me,a0 as ye,aW as pe}from"./vendor-D1O0VZ-0.js";import{I as ve}from"./play-CQXVBNXK.js";import"./@debug-lodash-BIjirobg.js";const Ee=()=>q(()=>import("./player.es-dPTG7EuZ.js"),[]),be=()=>q(()=>import("./index-1hFz9eqi.js").then(t=>t.i),__vite__mapDeps([0,1])),s={YOUTUBE:"youtube",VIMEO:"vimeo"},he=ae({name:"UiVideo",props:{src:{type:String,default:""},poster:{type:[String,Object],default:void 0},hasPlayBtn:{type:Boolean,default:!0},hasPlayAnim:{type:Boolean,default:!1},hasPlayRotate:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},controls:{type:Boolean,default:!0},cover:{type:String,default:"cover"},alt:{type:String,default:void 0},full:{type:Boolean,default:!1},sources:{type:Object,default:void 0}},emits:["play","pause","stop"],setup(t,{emit:a}){const{viewport:f}=F(b.state);let n=null;const e=ie({el:void 0,playEl:void 0,circle:void 0,iframe:void 0,video:void 0,VIDEO_PLATFOMS:s,rafMouse:void 0,clientX:0,clientY:0,defaultX:0,defaultY:0,format:void 0,isEmbedPlayer:!1,isInScreen:!1,state:{playing:!1,muted:!1,ended:!0,loaded:!0}}),{onInitUi:I}=te();se(()=>{e.state.muted=t.muted||t.autoplay,e.format=A(),e.isEmbedPlayer=H(),e.isEmbedPlayer?z():(M(),t.autoplay&&e.isInScreen&&m())}),I(()=>{le(e.el,([{isIntersecting:o}])=>{o&&(t.autoplay&&o&&m(),e.state.playing&&!o&&w(),o?y():l(),e.isInScreen=o)},{threshold:.3})}),re(()=>f.value.width,()=>{var o;(o=e.playEl)!=null&&o.$el&&u.set(e.playEl.$el,{clearProps:"left,top",onComplete:()=>{e.defaultX=e.playEl.$el.offsetLeft,e.defaultY=e.playEl.$el.offsetTop}})},{debounce:500,deep:!0}),ue(()=>{Q()}),de(()=>e.state,o=>{o.playing?l():y()},{deep:!0}),h.on(P.VIDEO_STOP_ALL,()=>{w()});const y=()=>{setTimeout(()=>{e.circle&&t.hasPlayRotate&&(e.timelineMouse=u.timeline().to(e.circle,{scale:.95,repeat:-1,yoyo:!0,duration:3}))},50)},l=()=>{e.timelineMouse&&e.timelineMouse.kill()},g=R(()=>typeof t.poster=="string"?{src:t.poster}:t.poster),A=()=>{var o,i,r;return((o=t.src)==null?void 0:o.search("youtube"))>=0||((i=t.src)==null?void 0:i.search("youtu.be"))>=0?s.YOUTUBE:((r=t.src)==null?void 0:r.search("vimeo"))>=0?s.VIMEO:typeof t.src!="string"||t.src===""?"":`video/${oe.getFileExtension(t.src)}`},H=()=>[s.YOUTUBE,s.VIMEO].indexOf(A())>=0,p=()=>{e.state.playing=!0,e.state.ended=!1,a("play"),h.emit(P.STOP_INACTIVE)},v=()=>{e.state.playing=!1,e.state.ended=!1,a("pause"),h.emit(P.RESET_INACTIVE)},E=()=>{e.state.playing=!1,e.state.ended=!0,a("stop"),h.emit(P.RESET_INACTIVE)},j=o=>{switch(o.data){case 1:return p();case 2:return v();case 0:case 5:return E();default:return null}},z=()=>{V(()=>{switch(e.format){case s.YOUTUBE:be().then(o=>{const i=o.default,r=Pe(t.src);n=i(e.iframe,{host:"https://www.youtube-nocookie.com"}),n&&(t.muted&&n.mute(),n.loadVideoById(r).then(()=>n.stopVideo()).then(()=>{M(),t.autoplay&&e.isInScreen&&m()}))});break;case s.VIMEO:Ee().then(o=>{const i=o.default;n=new i(e.iframe,{url:t.src,loop:t.loop,muted:t.muted,controls:t.controls,dnt:!0}),n.on("loaded",()=>{M(),t.autoplay&&e.isInScreen&&m()})});break}})},M=()=>{if(e.isEmbedPlayer)switch(e.format){case s.YOUTUBE:n.on("stateChange",j);break;case s.VIMEO:n.on("play",p),n.on("pause",v),n.on("ended",E);break}else e.video&&(e.video.addEventListener("play",p),e.video.addEventListener("pause",v),e.video.addEventListener("ended",E))},Q=()=>{!e.isEmbedPlayer&&e.video&&(e.video.removeEventListener("play",p),e.video.removeEventListener("pause",v),e.video.removeEventListener("ended",E))};function m(){document.querySelectorAll("video").forEach(o=>o.pause()),V(()=>{var o;if(e.isEmbedPlayer)switch(e.format){case s.YOUTUBE:return n==null?void 0:n.playVideo();case s.VIMEO:return n.play();default:return new Promise((i,r)=>{r(new Error("incorrect video url"))})}return(o=e.video)==null?void 0:o.play()})}function Z(){var o;if(e.isEmbedPlayer)switch(e.format){case s.YOUTUBE:return n.pauseVideo();case s.VIMEO:return n.pause();default:return new Promise((i,r)=>{r(new Error("incorrect video url"))})}return(o=e.video)==null?void 0:o.pause()}function w(){var o;if(e.isEmbedPlayer){if(!n)return new Promise(i=>{i(null)});switch(e.format){case s.YOUTUBE:return n.stopVideo();case s.VIMEO:return n.getDuration().then(i=>(n.setCurrentTime(i-.5),n));default:return new Promise((i,r)=>{r(new Error("incorrect video url"))})}}if(e.video){(o=e.video)==null||o.pause();const{duration:i}=e.video;!Number.isNaN(i)&&e.video&&(e.video.currentTime=0)}return new Promise(i=>{i(null)})}function G(o=!0){e.state.muted=o}function J(){e.state.muted=!1}function K(){var o;b.isDesktopDevice&&((o=e.playEl)!=null&&o.$el&&t.hasPlayAnim&&(e.defaultX||(e.defaultX=e.playEl.$el.offsetLeft,e.defaultY=e.playEl.$el.offsetTop),e.rafMouse=requestAnimationFrame(L)),e.timelineMouse&&e.timelineMouse.timeScale(1.4))}function L(){var o;(o=e.playEl)!=null&&o.$el&&u.to(e.playEl.$el,.25,{left:e.clientX,top:e.clientY}),e.rafMouse=requestAnimationFrame(L)}function x(){b.isDesktopDevice&&(t.hasPlayAnim&&V(()=>{var o;cancelAnimationFrame(e.rafMouse),(o=e.playEl)!=null&&o.$el&&u.to(e.playEl.$el,.8,{left:e.defaultX,top:e.defaultY,overwrite:!0})}),e.timelineMouse&&e.timelineMouse.timeScale(1))}function ee(o){var i;if(t.hasPlayAnim&&b.isDesktopDevice){if((window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<1e3||!((i=e.playEl)!=null&&i.$el)||!e.el)return!1;const O=e.playEl.$el.getBoundingClientRect().width/2,S=e.playEl.$el.getBoundingClientRect().height/2,Y=10+O,U=e.el.getBoundingClientRect().width-10-O,$=10+S,D=e.el.getBoundingClientRect().height-10-S,B=o.clientX-e.el.getBoundingClientRect().left,T=o.clientY-e.el.getBoundingClientRect().top;B<=Y?e.clientX=Y:B>=U?e.clientX=U:e.clientX=B,T<=$?e.clientY=$:T>=D?e.clientY=D:e.clientY=T}return!0}return{...F(e),posterProps:g,IconPlay:ve,onClick:m,play:m,pause:Z,stop:w,mute:G,unmute:J,isPlaying:R(()=>e.state.playing),beforeEnterAction:ge,enterAction:Me,leaveAction:we,beforeEnterActionFade:Be,enterActionFade:Te,leaveActionFade:Ve,onMouseEnter:K,onMouseLeave:x,onMouseMove:ee}}}),Pe=t=>{const a=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,f=t.match(a);return f&&f[7].length===11?f[7]:""},ge=t=>{u.set(t,{opacity:0,scale:.4})},Me=(t,a)=>{u.to(t,{duration:.4,opacity:1,delay:.2,scale:1,onComplete:a})},we=(t,a)=>{u.to(t,{duration:.2,opacity:0,scale:.4,onComplete:a})},Be=t=>{u.set(t,{opacity:0})},Te=(t,a)=>{u.to(t,{duration:.4,opacity:1,delay:.2,onComplete:a})},Ve=(t,a)=>{u.to(t,{duration:.2,opacity:0,onComplete:a})},ke=["data-cover","data-full","data-playing"],Ce={ref:"circle",class:"circle"},Ie=["innerHTML"],Ae={key:0,ref:"iframe",class:"video -embed"},Le=["loop","muted","autoplay","controls"],Oe=["src","type"],Se=["src","type"];function Ye(t,a,f,n,e,I){const y=ce("ui-button");return d(),c("div",{ref:"el",key:t.src,class:"UIVideo","data-cover":t.cover,"data-full":t.full,"data-playing":t.isPlaying},[X(_,{css:!1,onBeforeEnter:t.beforeEnterAction,onEnter:t.enterAction,onLeave:t.leaveAction},{default:k(()=>[t.state.ended||!t.state.playing?(d(),c("div",{key:0,class:"actions",onClick:a[0]||(a[0]=(...l)=>t.onClick&&t.onClick(...l)),onMouseenter:a[1]||(a[1]=(...l)=>t.onMouseEnter&&t.onMouseEnter(...l)),onMouseleave:a[2]||(a[2]=(...l)=>t.onMouseLeave&&t.onMouseLeave(...l)),onMousemove:a[3]||(a[3]=(...l)=>t.onMouseMove&&t.onMouseMove(...l))},[t.hasPlayBtn?(d(),N(y,{key:0,ref:"playEl",theme:"reset",class:"button test",name:"play","aria-label":"play-button"},{default:k(()=>[W("span",Ce,null,512),W("span",{class:"icon",innerHTML:t.IconPlay},null,8,Ie)]),_:1},512)):C("",!0)],32)):C("",!0)]),_:1},8,["onBeforeEnter","onEnter","onLeave"]),X(_,{css:!1,onBeforeEnter:t.beforeEnterActionFade,onEnter:t.enterActionFade,onLeave:t.leaveActionFade},{default:k(()=>[!t.state.playing||t.state.ended?(d(),N(fe(t.poster?"ui-picture":"div"),me({key:0,class:"poster"},t.posterProps,{alt:"",full:"",cover:"cover",lazy:!1,sizes:"(min-width: 1024px) 50vw, 100vw"}),null,16)):C("",!0)]),_:1},8,["onBeforeEnter","onEnter","onLeave"]),t.isEmbedPlayer?(d(),c("div",Ae,null,512)):(d(),c("video",{key:1,ref:"video",loop:t.loop,muted:t.state.muted,autoplay:t.autoplay,controls:t.controls,disablepictureinpicture:"",class:"video -native",controlsList:"nodownload"},[t.sources?(d(!0),c(ye,{key:0},pe(t.sources,(l,g)=>(d(),c("source",{key:l,src:l,type:`video/${g}`},null,8,Oe))),128)):(d(),c("source",{key:1,src:t.src,type:t.format},null,8,Se))],8,Le))],8,ke)}const Re=ne(he,[["render",Ye],["__scopeId","data-v-89409283"]]);export{Re as default};
//# sourceMappingURL=index-LKkdPVDY.js.map
