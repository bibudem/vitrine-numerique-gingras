const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-1hFz9eqi.js","assets/@debug-lodash-BIjirobg.js"])))=>i.map(i=>d[i]);
import{a as b,u as Q,e as x,E as ee,S as te,b as N,_ as oe}from"./app-8gBICEsG.js";import{d as ne,ay as $,aW as ae,b7 as se,b3 as le,b4 as ie,q as u,bO as re,W as ue,l as de,p as B,aS as ce,o as d,Z as c,aT as D,_ as k,e as F,aU as X,g as L,a$ as R,$ as fe,b6 as me,a0 as ye,aX as pe}from"./vendor-Dk7UPmZi.js";import{I as ve}from"./play-CQXVBNXK.js";import"./@debug-lodash-BIjirobg.js";const Ee=()=>N(()=>import("./player.es-dPTG7EuZ.js"),[]),be=()=>N(()=>import("./index-1hFz9eqi.js").then(t=>t.i),__vite__mapDeps([0,1])),l={YOUTUBE:"youtube",VIMEO:"vimeo"},he=ne({name:"UiVideo",props:{src:{type:String,default:""},poster:{type:[String,Object],default:void 0},hasPlayBtn:{type:Boolean,default:!0},hasPlayAnim:{type:Boolean,default:!1},hasPlayRotate:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},controls:{type:Boolean,default:!0},cover:{type:String,default:"cover"},alt:{type:String,default:void 0},full:{type:Boolean,default:!1},sources:{type:Object,default:void 0}},emits:["play","pause","stop"],setup(t,{emit:a}){const{viewport:f}=$(b.state);let n=null;const e=ae({el:void 0,playEl:void 0,circle:void 0,iframe:void 0,video:void 0,VIDEO_PLATFOMS:l,rafMouse:void 0,clientX:0,clientY:0,defaultX:0,defaultY:0,format:void 0,isEmbedPlayer:!1,isInScreen:!1,state:{playing:!1,muted:!1,ended:!0,loaded:!0}}),{onInitUi:O}=Q();se(()=>{e.state.muted=t.muted||t.autoplay,e.format=V(),e.isEmbedPlayer=W(),e.isEmbedPlayer?H():(P(),t.autoplay&&e.isInScreen&&m())}),O(()=>{le(e.el,([{isIntersecting:o}])=>{o&&(t.autoplay&&o&&m(),e.state.playing&&!o&&M(),o?y():i(),e.isInScreen=o)},{threshold:.3})}),ie(()=>f.value.width,()=>{var o;(o=e.playEl)!=null&&o.$el&&u.set(e.playEl.$el,{clearProps:"left,top",onComplete:()=>{e.defaultX=e.playEl.$el.offsetLeft,e.defaultY=e.playEl.$el.offsetTop}})},{debounce:500,deep:!0}),re(()=>{_()}),ue(()=>e.state,o=>{o.playing?i():y()},{deep:!0}),x.on(ee.VIDEO_STOP_ALL,()=>{M()});const y=()=>{setTimeout(()=>{e.circle&&t.hasPlayRotate&&(e.timelineMouse=u.timeline().to(e.circle,{scale:.95,repeat:-1,yoyo:!0,duration:3}))},50)},i=()=>{e.timelineMouse&&e.timelineMouse.kill()},h=de(()=>typeof t.poster=="string"?{src:t.poster}:t.poster),V=()=>{var o,s,r;return((o=t.src)==null?void 0:o.search("youtube"))>=0||((s=t.src)==null?void 0:s.search("youtu.be"))>=0?l.YOUTUBE:((r=t.src)==null?void 0:r.search("vimeo"))>=0?l.VIMEO:typeof t.src!="string"||t.src===""?"":`video/${te.getFileExtension(t.src)}`},W=()=>[l.YOUTUBE,l.VIMEO].indexOf(V())>=0,p=()=>{e.state.playing=!0,e.state.ended=!1,a("play")},v=()=>{e.state.playing=!1,e.state.ended=!1,a("pause")},E=()=>{e.state.playing=!1,e.state.ended=!0,a("stop")},q=o=>{switch(o.data){case 1:return p();case 2:return v();case 0:case 5:return E();default:return null}},H=()=>{B(()=>{switch(e.format){case l.YOUTUBE:be().then(o=>{const s=o.default,r=Pe(t.src);n=s(e.iframe,{host:"https://www.youtube-nocookie.com"}),n&&(t.muted&&n.mute(),n.loadVideoById(r).then(()=>n.stopVideo()).then(()=>{P(),t.autoplay&&e.isInScreen&&m()}))});break;case l.VIMEO:Ee().then(o=>{const s=o.default;n=new s(e.iframe,{url:t.src,loop:t.loop,muted:t.muted,controls:t.controls,dnt:!0}),n.on("loaded",()=>{P(),t.autoplay&&e.isInScreen&&m()})});break}})},P=()=>{if(e.isEmbedPlayer)switch(e.format){case l.YOUTUBE:n.on("stateChange",q);break;case l.VIMEO:n.on("play",p),n.on("pause",v),n.on("ended",E);break}else e.video&&(e.video.addEventListener("play",p),e.video.addEventListener("pause",v),e.video.addEventListener("ended",E))},_=()=>{!e.isEmbedPlayer&&e.video&&(e.video.removeEventListener("play",p),e.video.removeEventListener("pause",v),e.video.removeEventListener("ended",E))};function m(){document.querySelectorAll("video").forEach(o=>o.pause()),B(()=>{var o;if(e.isEmbedPlayer)switch(e.format){case l.YOUTUBE:return n==null?void 0:n.playVideo();case l.VIMEO:return n.play();default:return new Promise((s,r)=>{r(new Error("incorrect video url"))})}return(o=e.video)==null?void 0:o.play()})}function j(){var o;if(e.isEmbedPlayer)switch(e.format){case l.YOUTUBE:return n.pauseVideo();case l.VIMEO:return n.pause();default:return new Promise((s,r)=>{r(new Error("incorrect video url"))})}return(o=e.video)==null?void 0:o.pause()}function M(){var o;if(e.isEmbedPlayer){if(!n)return new Promise(s=>{s(null)});switch(e.format){case l.YOUTUBE:return n.stopVideo();case l.VIMEO:return n.getDuration().then(s=>(n.setCurrentTime(s-.5),n));default:return new Promise((s,r)=>{r(new Error("incorrect video url"))})}}if(e.video){(o=e.video)==null||o.pause();const{duration:s}=e.video;!Number.isNaN(s)&&e.video&&(e.video.currentTime=0)}return new Promise(s=>{s(null)})}function z(o=!0){e.state.muted=o}function Z(){e.state.muted=!1}function G(){var o;b.isDesktopDevice&&((o=e.playEl)!=null&&o.$el&&t.hasPlayAnim&&(e.defaultX||(e.defaultX=e.playEl.$el.offsetLeft,e.defaultY=e.playEl.$el.offsetTop),e.rafMouse=requestAnimationFrame(C)),e.timelineMouse&&e.timelineMouse.timeScale(1.4))}function C(){var o;(o=e.playEl)!=null&&o.$el&&u.to(e.playEl.$el,.25,{left:e.clientX,top:e.clientY}),e.rafMouse=requestAnimationFrame(C)}function J(){b.isDesktopDevice&&(t.hasPlayAnim&&B(()=>{var o;cancelAnimationFrame(e.rafMouse),(o=e.playEl)!=null&&o.$el&&u.to(e.playEl.$el,.8,{left:e.defaultX,top:e.defaultY,overwrite:!0})}),e.timelineMouse&&e.timelineMouse.timeScale(1))}function K(o){var s;if(t.hasPlayAnim&&b.isDesktopDevice){if((window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<1e3||!((s=e.playEl)!=null&&s.$el)||!e.el)return!1;const T=e.playEl.$el.getBoundingClientRect().width/2,A=e.playEl.$el.getBoundingClientRect().height/2,Y=10+T,I=e.el.getBoundingClientRect().width-10-T,S=10+A,U=e.el.getBoundingClientRect().height-10-A,w=o.clientX-e.el.getBoundingClientRect().left,g=o.clientY-e.el.getBoundingClientRect().top;w<=Y?e.clientX=Y:w>=I?e.clientX=I:e.clientX=w,g<=S?e.clientY=S:g>=U?e.clientY=U:e.clientY=g}return!0}return{...$(e),posterProps:h,IconPlay:ve,onClick:m,play:m,pause:j,stop:M,mute:z,unmute:Z,beforeEnterAction:Me,enterAction:we,leaveAction:ge,beforeEnterActionFade:Be,enterActionFade:ke,leaveActionFade:Le,onMouseEnter:G,onMouseLeave:J,onMouseMove:K}}}),Pe=t=>{const a=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/,f=t.match(a);return f&&f[7].length===11?f[7]:""},Me=t=>{u.set(t,{opacity:0,scale:.4})},we=(t,a)=>{u.to(t,{duration:.4,opacity:1,delay:.2,scale:1,onComplete:a})},ge=(t,a)=>{u.to(t,{duration:.2,opacity:0,scale:.4,onComplete:a})},Be=t=>{u.set(t,{opacity:0})},ke=(t,a)=>{u.to(t,{duration:.4,opacity:1,delay:.2,onComplete:a})},Le=(t,a)=>{u.to(t,{duration:.2,opacity:0,onComplete:a})},Oe=["data-cover","data-full"],Ve={ref:"circle",class:"circle"},Ce=["innerHTML"],Te={key:0,ref:"iframe",class:"video -embed"},Ae=["loop","muted","autoplay","controls"],Ye=["src","type"],Ie=["src","type"];function Se(t,a,f,n,e,O){const y=ce("ui-button");return d(),c("div",{ref:"el",key:t.src,class:"UIVideo","data-cover":t.cover,"data-full":t.full},[D(R,{css:!1,onBeforeEnter:t.beforeEnterAction,onEnter:t.enterAction,onLeave:t.leaveAction},{default:k(()=>[t.state.ended||!t.state.playing?(d(),c("div",{key:0,class:"actions",onClick:a[0]||(a[0]=(...i)=>t.onClick&&t.onClick(...i)),onMouseenter:a[1]||(a[1]=(...i)=>t.onMouseEnter&&t.onMouseEnter(...i)),onMouseleave:a[2]||(a[2]=(...i)=>t.onMouseLeave&&t.onMouseLeave(...i)),onMousemove:a[3]||(a[3]=(...i)=>t.onMouseMove&&t.onMouseMove(...i))},[t.hasPlayBtn?(d(),F(y,{key:0,ref:"playEl",theme:"reset",class:"button",name:"play","aria-label":"play-button"},{default:k(()=>[X("span",Ve,null,512),X("span",{class:"icon",innerHTML:t.IconPlay},null,8,Ce)]),_:1},512)):L("",!0)],32)):L("",!0)]),_:1},8,["onBeforeEnter","onEnter","onLeave"]),D(R,{css:!1,onBeforeEnter:t.beforeEnterActionFade,onEnter:t.enterActionFade,onLeave:t.leaveActionFade},{default:k(()=>[!t.state.playing||t.state.ended?(d(),F(fe(t.poster?"ui-picture":"div"),me({key:0,class:"poster"},t.posterProps,{alt:"",full:"",cover:"cover",lazy:!1,sizes:"(min-width: 1024px) 50vw, 100vw"}),null,16)):L("",!0)]),_:1},8,["onBeforeEnter","onEnter","onLeave"]),t.isEmbedPlayer?(d(),c("div",Te,null,512)):(d(),c("video",{key:1,ref:"video",loop:t.loop,muted:t.state.muted,autoplay:t.autoplay,controls:t.controls,class:"video -native",controlsList:"nodownload"},[t.sources?(d(!0),c(ye,{key:0},pe(t.sources,(i,h)=>(d(),c("source",{key:i,src:i,type:`video/${h}`},null,8,Ye))),128)):(d(),c("source",{key:1,src:t.src,type:t.format},null,8,Ie))],8,Ae))],8,Oe)}const Xe=oe(he,[["render",Se],["__scopeId","data-v-b331a4c6"]]);export{Xe as default};
//# sourceMappingURL=index-DOHw5ahE.js.map
