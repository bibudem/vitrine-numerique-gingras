{"version":3,"file":"index-Bg5kR7_Z.js","sources":["../../src/vue/src/components/UiKit/Lightbox/index.vue"],"sourcesContent":["<docs>\n  # UiLightbox\n> Show content in a lightbox, simple wrapper for content of lightbox\n\n@author Kevin Bastien <kevin@kffein.com>\n</docs>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, onMounted, reactive, toRefs, PropType } from 'vue';\nimport { onKeyStroke, templateRef } from '@vueuse/core';\nimport { client } from 'config';\nimport { store as interfaceStore } from 'store/interface';\nimport { store as scrollStore } from 'components/SmoothScroll/store';\nimport { gsap } from 'vendors/gsap';\nimport emitter, { EVENTS } from 'store/events'\nimport { useI18n } from 'vue-i18n';\n\nexport interface Data {\n  active: boolean,\n  clientX: number,\n  clientY: number,\n  reqFrame: any,\n}\n\nexport default defineComponent({\n  name: 'UiLightbox',\n  props: {\n    /**\n      * Theme : \n      *  - standard : classic\n      *  - nopad : without any padding\n      *  - full : fullscreen\n    */\n    theme: {\n      type: String as PropType<LightboxTheme>,\n      default: 'standard',\n    },\n    /**\n      * display custom cursor close CTA on desktop\n    */\n    cursor: {\n      type: Boolean,\n      default: true,\n    },\n    /**\n      * display confirmation Ctas at the end of the lightbox body.\n      * it will emit these 2 events : `accept` & `reject`\n    */\n    confirm: {\n      type: Boolean,\n      default: false,\n    }\n  },\n  emits: ['accept', 'reject', 'close', 'open'],\n  setup(props, { emit }) {\n    const {t} = useI18n()\n    const data: Data = reactive(\n      {\n        active: false,\n        clientX: -100,\n        clientY: -100,\n        reqFrame: null,\n      }\n    );\n    const isDesktop = computed( () => interfaceStore.isDesktop);\n\n    const scrollElement = templateRef('scrollElement')\n    const cursorElement = templateRef('cursorElement')\n\n    // const isVideo = computed(() => {\n    //   return props.type === 'video';\n    // });\n    // watch open in store to toggle leave/enter\n    // watch(\n    //   () => lightboxStore.isOpen,\n    //   (value: any) => {\n    //     if (value) {\n    //       enter()\n    //     } else {\n    //       leave()\n    //     }\n    //   },\n    //   { deep: true }\n    // )\n\n    emitter.on(EVENTS.LIGHTBOX_CLOSE_ALL, () => {\n      stop();\n    });\n\n    const open = () => {\n      emitter.emit(EVENTS.LIGHTBOX_CLOSE_ALL);\n\n      data.active = true;\n      if (props.cursor) {\n        initCursor();\n      }\n      if (scrollElement?.value) {\n        scrollStore.setScrollable(false);\n      }\n      emit('open');\n    }\n\n    const accept = () => {\n      close()\n      emit('accept');\n    }\n\n    const reject = () => {\n      close()\n      emit('reject');\n    }\n\n    const close = () => {\n      if (props.cursor) {\n        destroyCursor()\n      }\n      if (scrollElement?.value) {\n        scrollStore.setScrollable(true);\n      }\n      data.active = false\n      emit('close');\n    }\n\n    const initCursor = () => {\n      const cursor = cursorElement?.value;\n      // add listener to track the current mouse position\n      document.addEventListener('mousemove', (e) => {\n        data.clientX = e.clientX;\n        data.clientY = e.clientY;\n      });\n\n      // transform the cursor to the current mouse position\n      // use requestAnimationFrame() for smooth performance\n      const render = () => {\n        gsap.set(cursor, {\n          x: data.clientX,\n          y: data.clientY,\n        });\n\n        data.reqFrame = requestAnimationFrame(render);\n      };\n      data.reqFrame = requestAnimationFrame(render);\n    }\n\n    const destroyCursor = () => {\n      // remove listener and animationFrame\n      cancelAnimationFrame(data.reqFrame);\n      document.removeEventListener('mousemove', (e) => {\n        data.clientX = e.clientX;\n        data.clientY = e.clientY;\n      });\n    }\n\n    onMounted(() => {\n      if (client) {\n        // close lightbox when click on ESC\n        onKeyStroke('Escape', () => {\n          if (data.active) {\n            close();\n          }\n        }, { target: document })\n\n      }\n    });\n\n    return {\n      t,\n      ...toRefs(data), //data\n      isDesktop,\n      open,\n      close,\n      accept,\n      reject,\n    };\n  },\n});\n</script>\n\n<template>\n  <Teleport to=\"body\">\n    <div :data-open=\"active\"\n         :theme=\"theme\"\n         :class=\"['UiLightbox']\"\n    >\n      <div ref=\"Overlay\"\n           :class=\"`overlay ${cursor ? '-cursor' : ''}`\"\n           @click=\"close()\"\n      />\n      <button v-if=\"cursor\"\n              ref=\"cursorElement\"\n              type=\"button\"\n              class=\"close -outside\"\n              :aria-label=\"t('LABELS.close')\"\n              @click=\"close()\"\n      />\n  \n      <div class=\"content-container\" data-lenis-prevent>\n        <div ref=\"content\" class=\"content\">\n          <button v-if=\"theme == 'full' || !cursor || (cursor && !isDesktop)\"\n                  type=\"button\"\n                  class=\"close -inside\"\n                  :aria-label=\"t('LABELS.close')\"\n                  @click=\"close()\"\n          />\n          <div ref=\"scrollElement\"\n               class=\"inner-content\"\n               data-lenis-prevent\n          >\n            <div class=\"body\" data-lenis-prevent>\n              <slot />\n\n              <div v-if=\"confirm\" class=\"confirm\">\n                <ui-button :label=\"t('LABELS.accept')\"\n                           theme=\"primary\"\n                           @click=\"accept\"\n                />\n                <ui-button :label=\"t('LABELS.reject')\"\n                           theme=\"secondary\"\n                           @click=\"reject\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </Teleport>\n</template>\n<style lang=\"stylus\" scoped>\n  /**\n   * TABLE OF CONTENT\n   * --------\n   *  - LAYOUT\n   *  - DEBUG\n   *  - NO_SCOPE\n   */\n\n  //  ===LAYOUT===\n  .UiLightbox\n    opacity 0\n    fixed top left\n    width 100%\n    height var(--viewport-innerHeight)\n    // height -webkit-fill-available\n    pointer-events none\n    z-index $z-lightbox\n    trans()\n    &[data-open=\"true\"]\n      pointer-events all\n      opacity 1\n      .content\n        pointer-events all\n\n\n  .overlay\n    background rgba($c-black, .6)\n    absolute top left\n    size 100%\n    cursor auto\n    &.-cursor\n      cursor none\n\n  .content-container\n    position relative\n    height 100%\n    f($align: center, $justify: center)\n    z-index 200\n    pointer-events none\n    \n    +layout(mobile)\n      margin 0 auto\n      width 100%\n      height auto\n      min-height 100vh\n      /* mobile viewport bug fix */\n      min-height -webkit-fill-available\n      max-width none\n      // align-items flex-end\n      align-items center\n\n  .content\n    position relative\n    width 100%\n    background white\n\n    +layout(mobile)\n      max-width 100%\n      // height 100% // if you want full height modale\n\n  .inner-content\n    overflow-y auto\n    overflow-x hidden\n    -webkit-overflow-scrolling touch\n    height 100%\n    max-height 85vh\n    position relative\n    z-index 10\n\n    +layout(mobile)\n      min-height var(--viewport-innerHeight)\n      max-height var(--viewport-innerHeight)\n      height auto\n\n  .body\n    rp(padding-top, 135px 65px)\n    rp(padding-bottom, 135px 15px)\n    rp(padding-left, 100px 15px)\n    rp(padding-right, 100px 15px)\n    margin-left auto\n    margin-right auto\n\n  .close\n    cursor pointer\n    rp(size, 44px 22px)\n    padding 0\n    border-radius 0\n    background none\n    border none\n    transform rotate(45deg)\n    transform-origin center center\n    trans()\n    outline none\n    z-index 20\n    +layout(desktop)\n      fixed top left\n      transform translate(-50%, -50%) rotate(45deg)\n      cursor none\n      &.-inside\n        absolute top 30px right 30px left auto\n        transform translate(0, 0) rotate(45deg)\n        cursor pointer\n\n    +layout(mobile)\n      fixed top 18px right 10px\n      size 20px\n      z-index 100\n\n    &.-inside\n      z-index 30\n    &.-outside\n      &::before\n      &::after\n        background $c-white\n\n    &:hover\n      transform rotate(135deg)\n\n    &::before\n      content ''\n      absolute top 50% left\n      transform translateY(-50%)\n      width 100%\n      height 1px\n      background $c-black\n\n    &::after\n      content ''\n      absolute top left 50%\n      transform translateX(-50%)\n      height 100%\n      width 1px\n      background $c-black\n\n  .confirm\n    rp(margin-top, 54px 30px)\n    > *\n      rp(margin-right, 54px 30px)\n      &:last-child\n        margin-right 0\n\n  // THEMES\n  &[theme=\"standard\"]\n    .content-container\n      +layout(desktop)\n        container()\n  &[theme=\"nopad\"]\n    .content-container\n      +layout(desktop)\n        container()\n    .body\n      padding 0\n  &[theme=\"full\"]\n    .body\n      padding 0\n    \n    .content\n      min-height var(--viewport-innerHeight)\n\n  //  ===DEBUG===\n  [data-debug-mode=\"true\"] .Lightbox\n    //\n</style>\n"],"names":["_sfc_main","defineComponent","props","emit","t","useI18n","data","reactive","isDesktop","computed","interfaceStore","scrollElement","templateRef","cursorElement","emitter","EVENTS","open","initCursor","scrollStore","accept","close","reject","destroyCursor","cursor","e","render","gsap","onMounted","client","onKeyStroke","toRefs","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_component_ui_button","_resolveComponent","_openBlock","_createBlock","_Teleport","_createElementVNode","_ctx","_normalizeClass","_cache","$event","_createElementBlock","_createCommentVNode","_renderSlot","_createVNode"],"mappings":"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"}