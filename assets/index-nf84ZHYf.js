const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Form-BRFYt389.js","assets/vendor-BT8TDTHT.js","assets/@debug-lodash-BIjirobg.js","assets/LocalStorage-BJPYtshR.js","assets/app-UYNKwKlQ.js","assets/app-CjUdizv2.css","assets/index-DX56Q6wl.js","assets/Form-C6sWZcXa.css","assets/index-BTcR9rSe.js","assets/index-Cq63lNxA.css"])))=>i.map(i=>d[i]);
import{bu as _baseRest,bv as eq_1,br as _isIterateeCall,bw as keysIn_1,bx as _Set,by as _setToArray,bz as _SetCache,bA as _arrayIncludes,bB as _arrayIncludesWith,bC as _cacheHas,f as find,bD as _baseIsEqual,ae as isArray$1,al as each,ah as has,c as map$2,h as defineAsyncComponent,bE as _arrayPush,bF as _baseFlatten,bG as _copyArray,bH as isArray_1,bI as map_1,bJ as _baseSlice,bK as toInteger_1,bL as _baseIteratee,j as defineStore,r as ref,l as computed,d as defineComponent,aP as useI18n,ay as toRefs,aO as useRoute,aV as useRouter$1,aQ as templateRef,b6 as reactive,bM as onClickOutside,aS as resolveComponent,o as openBlock,Z as createElementBlock,a2 as toDisplayString,g as createCommentVNode,e as createBlock,_ as withCtx,aT as createVNode,b8 as mergeProps,aU as createBaseVNode,a0 as Fragment,aW as renderList,b0 as Transition,b3 as TransitionGroup,a_ as normalizeClass}from"./vendor-BT8TDTHT.js";import{i as i18n,b as __vitePreload,p as pinia,d as useRouter,f as store$1,u as useFlow,_ as _export_sfc}from"./app-UYNKwKlQ.js";import{g as getDefaultExportFromCjs}from"./@debug-lodash-BIjirobg.js";import{a as api}from"./index-DX56Q6wl.js";var baseRest=_baseRest,eq=eq_1,isIterateeCall$1=_isIterateeCall,keysIn=keysIn_1,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,defaults=baseRest(function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&isIterateeCall$1(t[0],t[1],i)&&(n=1);++r<n;)for(var s=t[r],a=keysIn(s),o=-1,l=a.length;++o<l;){var u=a[o],d=e[u];(d===void 0||eq(d,objectProto[u])&&!hasOwnProperty.call(e,u))&&(e[u]=s[u])}return e}),defaults_1=defaults;const defaults$1=getDefaultExportFromCjs(defaults_1);function noop$1(){}var noop_1=noop$1,Set=_Set,noop=noop_1,setToArray$1=_setToArray,INFINITY$1=1/0,createSet$1=Set&&1/setToArray$1(new Set([,-0]))[1]==INFINITY$1?function(e){return new Set(e)}:noop,_createSet=createSet$1,SetCache=_SetCache,arrayIncludes=_arrayIncludes,arrayIncludesWith=_arrayIncludesWith,cacheHas=_cacheHas,createSet=_createSet,setToArray=_setToArray,LARGE_ARRAY_SIZE=200;function baseUniq$2(e,t,r){var n=-1,i=arrayIncludes,s=e.length,a=!0,o=[],l=o;if(r)a=!1,i=arrayIncludesWith;else if(s>=LARGE_ARRAY_SIZE){var u=t?null:createSet(e);if(u)return setToArray(u);a=!1,i=cacheHas,l=new SetCache}else l=t?[]:o;e:for(;++n<s;){var d=e[n],p=t?t(d):d;if(d=r||d!==0?d:0,a&&p===p){for(var c=l.length;c--;)if(l[c]===p)continue e;t&&l.push(p),o.push(d)}else i(l,p,r)||(l!==o&&l.push(p),o.push(d))}return o}var _baseUniq=baseUniq$2,baseUniq$1=_baseUniq;function uniq(e){return e&&e.length?baseUniq$1(e):[]}var uniq_1=uniq;const uniq$1=getDefaultExportFromCjs(uniq_1),masks={zipCode:{mask:[{mask:"a0a-0a0",country:"ca"},{mask:"00000-0000",country:"usa"}],lazy:!0},phone:{mask:"(000) 000-0000",maxLength:10,autofix:!0,lazy:!0},creditCard:{mask:"0000 000000 00000",regex:"^3[47]\\d{0,13}",brand:"americanexpress",lazy:!0},cvc:{mask:"000",lazy:!0},creditCards:{dispatch(e,t){const r=(t.value+e).replace(/\D/g,"");return find(t.compiledMasks,n=>{const i=new RegExp(n.regex);return r.match(i)})},mask:[{mask:"0000 000000 00000",regex:"^3[47]\\d{0,13}",brand:"americanexpress"},{mask:"0000 0000 0000 0000",regex:"^(5[1-5]\\d{0,2}|22[2-9]\\d{0,1}|2[3-7]\\d{0,2})\\d{0,12}",brand:"mastercard"},{mask:"0000 0000 0000 0000",regex:"^4\\d{0,15}",brand:"visa"},{mask:"0000 0000 0000 0000",brand:null}],lazy:!0},date:{mask:Date,pattern:"d-m-Y",lazy:!0,format(e){let t=e.getDate(),r=e.getMonth()+1;const n=e.getFullYear();return t<10&&(t=`0${t}`),r<10&&(r=`0${r}`),[t,r,n].join("-")},parse(e){const t=e.split("-");return new Date(parseInt(t[2],10),parseInt(t[1],10)-1,parseInt(t[0],10))}}};var baseIsEqual=_baseIsEqual;function isEqual(e,t){return baseIsEqual(e,t)}var isEqual_1=isEqual;const isEqual$1=getDefaultExportFromCjs(isEqual_1),rules={REQUIRED(e){return isArray$1(e)&&!e.length?"required":(e||e===0)&&e!==""?!0:"required"},EMAIL_FORMAT(e){return!e||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)?!0:"email_format"},PHONE_FORMAT(e){return!e&&e!==0||/^(\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]?\d{3}[\s.-]?\d{4}$/i.test(e.toString())?!0:"phone_format"},POSTAL_FORMAT(e,t,r){if(!e)return!0;const n=r[t.target],i=n==null?void 0:n.value;if(i)switch(i){case 38:return rules.CA_POSTAL_FORMAT(e);default:return rules.USA_POSTAL_FORMAT(e)}return rules.BOTH_POSTAL_FORMAT(e)},CA_POSTAL_FORMAT(e){return!e||/^[ABCEGHJ-NPRSTVXY]\d[ABCEGHJ-NPRSTV-Z][ -]?\d[ABCEGHJ-NPRSTV-Z]\d$/i.test(e)?!0:"ca_postal_format"},USA_POSTAL_FORMAT(e){return!e||/^(\d{5}(-\d{4})?)$/g.test(e)?!0:"usa_postal_format"},BOTH_POSTAL_FORMAT(e){return!e||/^(\d{5}(-\d{4})?)$/g.test(e)||/^[ABCEGHJ-NPRSTVXY]\d[ABCEGHJ-NPRSTV-Z][ -]?\d[ABCEGHJ-NPRSTV-Z]\d$/i.test(e)?!0:"both_postal_format"},URL_FORMAT(e){return!e||/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/i.test(e)?!0:"url_format"},MAX(e,t){return e&&typeof e=="number"&&e<=t.max&&t.type!=="number"||t.type==="number"&&parseInt(e,10)<=t.max||e&&typeof e!="number"&&e.length<=t.max&&t.type!=="number"||!e?!0:{label:"max",attr:{max:t.max}}},MIN(e,t){return e&&typeof e=="number"&&e>=t.min&&t.type!=="number"||t.type==="number"&&parseInt(e,10)>=t.min||e&&typeof e!="number"&&e.length>=t.min&&t.type!=="number"||!e?!0:{label:"min",attr:{min:t.min}}},PASSWORD_IS_SAME(e,t,r){if(!e&&!t.target)return!0;const n=r[t.target],i=n==null?void 0:n.value;return!i||i&&isEqual$1(e,i)?!0:"password_dont_matches"},PASSWORD_WEAK(e){return e?e.length>=6||{label:"password_weak",attr:{num:6}}:!0},REGEX(e,t){const r=new RegExp(t.regex,"i");return e&&t.regex&&r.test(e)||!e||!r?!0:t.message?t.message:"generic"}},FORM_STATUS={PRISTINE:"PRISTINE",DEFAULT:"DEFAULT",SENDING:"SENDING",SUCCESS:"SUCCESS",ERROR:"ERROR",INVALID:"INVALID"},MASK_MODELS=masks,FORM_RULES=rules;function createValidationRules(e=[],t=!1){t===!0&&e.push("REQUIRED");const r=map$2(e,n=>{const i=()=>!0;return typeof n=="string"?FORM_RULES[n.toUpperCase()]?FORM_RULES[n.toUpperCase()]:(console.warn(`form validation rule named "${n}" is unknown`),i):typeof n=="function"?n:(console.warn("form validation rule unknown :",n),i)});return uniq$1(r)}function createFormModel(e,t){return each(e,(r,n)=>{each(r,(i,s)=>{(s==="label"||s==="placeholder")&&typeof i=="string"&&i.indexOf("@:")===0&&(r[s]=i18n.global.t(i.replace("@:","")))}),defaults$1(r,{default:null,type:"text",errors:[]}),!has(r,"value")&&has(r,"default")&&(r.value=r.default),r.validations=createValidationRules(r.validations,r.required),r.name||(r.name=n)}),e}const KoddeinForm=defineAsyncComponent(()=>__vitePreload(()=>import("./Form-BRFYt389.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),KoddeinField=defineAsyncComponent(()=>__vitePreload(()=>import("./index-BTcR9rSe.js"),__vite__mapDeps([8,4,1,2,5,9]))),Icon=`<svg xmlns="http://www.w3.org/2000/svg" width="19.86" height="12.73"><path d="M0 5.86h18L12.79.71 13.5 0l5.66 5.66.7.7-6.36 6.37-.71-.73L18 6.86H0z" fill-rule="evenodd"/></svg>
`;var arrayPush=_arrayPush,baseFlatten$2=_baseFlatten,copyArray=_copyArray,isArray=isArray_1;function concat$1(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return arrayPush(isArray(r)?copyArray(r):[r],baseFlatten$2(t,1))}var concat_1=concat$1;const concat$2=getDefaultExportFromCjs(concat_1);var baseFlatten$1=_baseFlatten,map$1=map_1;function flatMap(e,t){return baseFlatten$1(map$1(e,t),1)}var flatMap_1=flatMap;const flatMap$1=getDefaultExportFromCjs(flatMap_1);var baseFlatten=_baseFlatten,map=map_1,INFINITY=1/0;function flatMapDeep(e,t){return baseFlatten(map(e,t),INFINITY)}var flatMapDeep_1=flatMapDeep;const flatMapDeep$1=getDefaultExportFromCjs(flatMapDeep_1);var baseSlice=_baseSlice,isIterateeCall=_isIterateeCall,toInteger=toInteger_1;function slice(e,t,r){var n=e==null?0:e.length;return n?(r&&typeof r!="number"&&isIterateeCall(e,t,r)?(t=0,r=n):(t=t==null?0:toInteger(t),r=r===void 0?n:toInteger(r)),baseSlice(e,t,r)):[]}var slice_1=slice;const slice$1=getDefaultExportFromCjs(slice_1);var baseIteratee=_baseIteratee,baseUniq=_baseUniq;function uniqBy(e,t){return e&&e.length?baseUniq(e,baseIteratee(t)):[]}var uniqBy_1=uniqBy;const uniqBy$1=getDefaultExportFromCjs(uniqBy_1);function parse_option(e,t){return typeof e<"u"?e:t}function create_object_array(e){const t=Array(e);for(let r=0;r<e;r++)t[r]=create_object();return t}function get_keys(e){return Object.keys(e)}function create_object(){return Object.create(null)}function concat(e){return[].concat.apply([],e)}function sort_by_length_down(e,t){return t.length-e.length}function is_array(e){return e.constructor===Array}function is_string(e){return typeof e=="string"}function is_object(e){return typeof e=="object"}function is_function(e){return typeof e=="function"}function pipeline(e,t,r,n){if(e&&(t&&(e=replace(e,t)),this.matcher&&(e=replace(e,this.matcher)),this.stemmer&&1<e.length&&(e=replace(e,this.stemmer)),n&&1<e.length&&(e=collapse(e)),r||r==="")){const i=e.split(r);return this.filter?filter(i,this.filter):i}return e}const regex_whitespace=/[\p{Z}\p{S}\p{P}\p{C}]+/u;function init_filter(e){const t=create_object();for(let r=0,n=e.length;r<n;r++)t[e[r]]=1;return t}function init_stemmer_or_matcher(e,t){const r=get_keys(e),n=r.length,i=[];let s="",a=0;for(let o=0,l,u;o<n;o++)l=r[o],u=e[l],u?(i[a++]=regex(t?"(?!\\b)"+l+"(\\b|_)":l),i[a++]=u):s+=(s?"|":"")+l;return s&&(i[a++]=regex(t?"(?!\\b)("+s+")(\\b|_)":"("+s+")"),i[a]=""),i}function replace(e,t){for(let r=0,n=t.length;r<n&&(e=e.replace(t[r],t[r+1]),!!e);r+=2);return e}function regex(e){return new RegExp(e,"g")}function collapse(e){let t="",r="";for(let n=0,i=e.length,s;n<i;n++)(s=e[n])!==r&&(t+=r=s);return t}function filter(e,t){const r=e.length,n=[];for(let i=0,s=0;i<r;i++){const a=e[i];a&&!t[a]&&(n[s++]=a)}return n}function encode(e){return pipeline.call(this,(""+e).toLowerCase(),!1,regex_whitespace,!1)}const global_lang={},global_charset={};function apply_async(e){register$1(e,"add"),register$1(e,"append"),register$1(e,"search"),register$1(e,"update"),register$1(e,"remove")}function register$1(e,t){e[t+"Async"]=function(){const r=this,n=arguments,i=n[n.length-1];let s;is_function(i)&&(s=i,delete n[n.length-1]);const a=new Promise(function(o){setTimeout(function(){r.async=!0;const l=r[t].apply(r,n);r.async=!1,o(l)})});return s?(a.then(s),this):a}}function intersect(e,t,r,n){const i=e.length;let s=[],a,o,l=0;n&&(n=[]);for(let u=i-1;0<=u;u--){const d=e[u],p=d.length,c=create_object();let h=!a;for(let f=0;f<p;f++){const g=d[f],m=g.length;if(m)for(let x=0,_,F;x<m;x++)if(F=g[x],a){if(a[F]){if(!u){if(r)r--;else if(s[l++]=F,l===t)return s}(u||n)&&(c[F]=1),h=!0}if(n&&(_=(o[F]||0)+1,o[F]=_,_<i)){const b=n[_-2]||(n[_-2]=[]);b[b.length]=F}}else c[F]=1}if(n)a||(o=c);else if(!h)return[];a=c}if(n)for(let u=n.length-1,d,p;0<=u;u--){d=n[u],p=d.length;for(let c=0,h;c<p;c++)if(h=d[c],!a[h]){if(r)r--;else if(s[l++]=h,l===t)return s;a[h]=1}}return s}function intersect_union(e,t){const r=create_object(),n=create_object(),i=[];for(let s=0;s<e.length;s++)r[e[s]]=1;for(let s=0,a;s<t.length;s++){a=t[s];for(let o=0,l;o<a.length;o++)l=a[o],r[l]&&(n[l]||(n[l]=1,i[i.length]=l))}return i}function CacheClass(e){this.limit=e!==!0&&e,this.cache=create_object(),this.queue=[]}function searchCache(e,t,r){is_object(e)&&(e=e.query);let n=this.cache.get(e);return n||(n=this.search(e,t,r),this.cache.set(e,n)),n}CacheClass.prototype.set=function(e,t){if(!this.cache[e]){let r=this.queue.length;r===this.limit?delete this.cache[this.queue[r-1]]:r++;for(let n=r-1;0<n;n--)this.queue[n]=this.queue[n-1];this.queue[0]=e}this.cache[e]=t};CacheClass.prototype.get=function(e){const t=this.cache[e];if(this.limit&&t){const r=this.queue.indexOf(e);if(r){const n=this.queue[r-1];this.queue[r-1]=this.queue[r],this.queue[r]=n}}return t};CacheClass.prototype.del=function(e){for(let t=0,r,n;t<this.queue.length;t++)n=this.queue[t],r=this.cache[n],r.includes(e)&&(this.queue.splice(t--,1),delete this.cache[n])};const preset={memory:{charset:"latin:extra",resolution:3,minlength:4,fastupdate:!1},performance:{resolution:3,minlength:3,optimize:!1,context:{depth:2,resolution:1}},match:{charset:"latin:extra",tokenize:"reverse"},score:{charset:"latin:advanced",resolution:20,minlength:3,context:{depth:3,resolution:9}},default:{}};function apply_preset(e){if(is_string(e))e=preset[e];else{const t=e.preset;t&&(e=Object.assign({},t[t],e))}return e}function async(e,t,r,n,i,s,a,o){setTimeout(function(){const l=e(r?r+"."+n:n,JSON.stringify(a));l&&l.then?l.then(function(){t.export(e,t,r,i,s+1,o)}):t.export(e,t,r,i,s+1,o)})}function exportIndex(e,t,r,n,i,s){let a=!0;typeof s>"u"&&(a=new Promise(u=>{s=u}));let o,l;switch(i||(i=0)){case 0:if(o="reg",this.fastupdate){l=create_object();for(let u in this.register)l[u]=1}else l=this.register;break;case 1:o="cfg",l={doc:0,opt:this.optimize?1:0};break;case 2:o="map",l=this.map;break;case 3:o="ctx",l=this.ctx;break;default:typeof r>"u"&&s&&s();return}return async(e,t||this,r,o,n,i,l,s),a}function importIndex(e,t){if(t)switch(is_string(t)&&(t=JSON.parse(t)),e){case"cfg":this.optimize=!!t.opt;break;case"reg":this.fastupdate=!1,this.register=t;break;case"map":this.map=t;break;case"ctx":this.ctx=t;break}}function exportDocument(e,t,r,n,i,s){let a;if(typeof s>"u"&&(a=new Promise(o=>{s=o})),i||(i=0),n||(n=0),n<this.field.length){const o=this.field[n],l=this.index[o];t=this,setTimeout(function(){l.export(e,t,i?o:"",n,i++,s)||(n++,i=1,t.export(e,t,o,n,i,s))})}else{let o,l;switch(i){case 1:o="tag",l=this.tagindex,r=null;break;case 2:o="store",l=this.store,r=null;break;default:s();return}async(e,this,r,o,n,i,l,s)}return a}function importDocument(e,t){if(t)switch(is_string(t)&&(t=JSON.parse(t)),e){case"tag":this.tagindex=t;break;case"reg":this.fastupdate=!1,this.register=t;for(let n=0,i;n<this.field.length;n++)i=this.index[this.field[n]],i.register=t,i.fastupdate=!1;break;case"store":this.store=t;break;default:e=e.split(".");const r=e[0];e=e[1],r&&e&&this.index[r].import(e,t)}}function Index(e,t){if(!(this instanceof Index))return new Index(e);let r,n,i;e?(e=apply_preset(e),r=e.charset,n=e.lang,is_string(r)&&(r.indexOf(":")===-1&&(r+=":default"),r=global_charset[r]),is_string(n)&&(n=global_lang[n])):e={};let s,a,o=e.context||{};this.encode=e.encode||r&&r.encode||encode,this.register=t||create_object(),this.resolution=s=e.resolution||9,this.tokenize=i=r&&r.tokenize||e.tokenize||"strict",this.depth=i==="strict"&&o.depth,this.bidirectional=parse_option(o.bidirectional,!0),this.optimize=a=parse_option(e.optimize,!0),this.fastupdate=parse_option(e.fastupdate,!0),this.minlength=e.minlength||1,this.boost=e.boost,this.map=a?create_object_array(s):create_object(),this.resolution_ctx=s=o.resolution||1,this.ctx=a?create_object_array(s):create_object(),this.rtl=r&&r.rtl||e.rtl,this.matcher=(i=e.matcher||n&&n.matcher)&&init_stemmer_or_matcher(i,!1),this.stemmer=(i=e.stemmer||n&&n.stemmer)&&init_stemmer_or_matcher(i,!0),this.filter=(i=e.filter||n&&n.filter)&&init_filter(i),this.cache=(i=e.cache)&&new CacheClass(i)}Index.prototype.append=function(e,t){return this.add(e,t,!0)};Index.prototype.add=function(e,t,r,n){if(t&&(e||e===0)){if(!n&&!r&&this.register[e])return this.update(e,t);t=this.encode(""+t);const i=t.length;if(i){const s=create_object(),a=create_object(),o=this.depth,l=this.resolution;for(let u=0;u<i;u++){let d=t[this.rtl?i-1-u:u],p=d.length;if(d&&p>=this.minlength&&(o||!a[d])){let c=get_score(l,i,u),h="";switch(this.tokenize){case"full":if(2<p){for(let f=0;f<p;f++)for(let g=p;g>f;g--)if(g-f>=this.minlength){const m=get_score(l,i,u,p,f);h=d.substring(f,g),this.push_index(a,h,m,e,r)}break}case"reverse":if(1<p){for(let f=p-1;0<f;f--)if(h=d[f]+h,h.length>=this.minlength){const g=get_score(l,i,u,p,f);this.push_index(a,h,g,e,r)}h=""}case"forward":if(1<p){for(let f=0;f<p;f++)h+=d[f],h.length>=this.minlength&&this.push_index(a,h,c,e,r);break}default:if(this.boost&&(c=Math.min(0|c/this.boost(t,d,u),l-1)),this.push_index(a,d,c,e,r),o&&1<i&&u<i-1){const f=create_object(),g=this.resolution_ctx,m=d,x=Math.min(o+1,i-u);f[m]=1;for(let _=1;_<x;_++)if(d=t[this.rtl?i-1-u-_:u+_],d&&d.length>=this.minlength&&!f[d]){f[d]=1;const F=get_score(g+(i/2>g?0:1),i,u,x-1,_-1),b=this.bidirectional&&d>m;this.push_index(s,b?m:d,F,e,r,b?d:m)}}}}}this.fastupdate||(this.register[e]=1)}}return this};function get_score(e,t,r,n,i){return r&&1<e?t+(n||0)<=e?r+(i||0):0|(e-1)/(t+(n||0))*(r+(i||0))+1:0}Index.prototype.push_index=function(e,t,r,n,i,s){let a=s?this.ctx:this.map;if((!e[t]||s&&!e[t][s])&&(this.optimize&&(a=a[r]),s?(e=e[t]||(e[t]=create_object()),e[s]=1,a=a[s]||(a[s]=create_object())):e[t]=1,a=a[t]||(a[t]=[]),this.optimize||(a=a[r]||(a[r]=[])),(!i||!a.includes(n))&&(a[a.length]=n,this.fastupdate))){const o=this.register[n]||(this.register[n]=[]);o[o.length]=a}};Index.prototype.search=function(e,t,r){r||(!t&&is_object(e)?(r=e,e=r.query):is_object(t)&&(r=t));let n=[],i,s,a,o=0;if(r&&(e=r.query||e,t=r.limit,o=r.offset||0,s=r.context,a=r.suggest),e&&(e=this.encode(""+e),i=e.length,1<i)){const p=create_object(),c=[];for(let h=0,f=0,g;h<i;h++)if(g=e[h],g&&g.length>=this.minlength&&!p[g]){if(!this.optimize&&!a&&!this.map[g])return n;c[f++]=g,p[g]=1}e=c,i=e.length}if(!i)return n;t||(t=100);let l=this.depth&&1<i&&s!==!1,u=0,d;l?(d=e[0],u=1):1<i&&e.sort(sort_by_length_down);for(let p,c;u<i;u++){if(c=e[u],l?(p=this.add_result(n,a,t,o,i===2,c,d),(!a||p!==!1||!n.length)&&(d=c)):p=this.add_result(n,a,t,o,i===1,c),p)return p;if(a&&u==i-1){let h=n.length;if(h){if(h===1)return single_result(n[0],t,o)}else{if(l){l=0,u=-1;continue}return n}}}return intersect(n,t,o,a)};Index.prototype.add_result=function(e,t,r,n,i,s,a){let o=[],l=a?this.ctx:this.map;if(this.optimize||(l=get_array(l,s,a,this.bidirectional)),l){let u=0;const d=Math.min(l.length,a?this.resolution_ctx:this.resolution);for(let p=0,c=0,h,f;p<d&&(h=l[p],!(h&&(this.optimize&&(h=get_array(h,s,a,this.bidirectional)),n&&h&&i&&(f=h.length,f<=n?(n-=f,h=null):(h=h.slice(n),n=0)),h&&(o[u++]=h,i&&(c+=h.length,c>=r)))));p++);if(u){if(i)return single_result(o,r,0);e[e.length]=o;return}}return!t&&o};function single_result(e,t,r){return e.length===1?e=e[0]:e=concat(e),r||e.length>t?e.slice(r,r+t):e}function get_array(e,t,r,n){if(r){const i=n&&t>r;e=e[i?t:r],e=e&&e[i?r:t]}else e=e[t];return e}Index.prototype.contain=function(e){return!!this.register[e]};Index.prototype.update=function(e,t){return this.remove(e).add(e,t)};Index.prototype.remove=function(e,t){const r=this.register[e];if(r){if(this.fastupdate)for(let n=0,i;n<r.length;n++)i=r[n],i.splice(i.indexOf(e),1);else remove_index(this.map,e,this.resolution,this.optimize),this.depth&&remove_index(this.ctx,e,this.resolution_ctx,this.optimize);t||delete this.register[e],this.cache&&this.cache.del(e)}return this};function remove_index(e,t,r,n,i){let s=0;if(is_array(e))if(i){const a=e.indexOf(t);a!==-1?1<e.length&&(e.splice(a,1),s++):s++}else{i=Math.min(e.length,r);for(let a=0,o;a<i;a++)o=e[a],o&&(s=remove_index(o,t,r,n,i),!n&&!s&&delete e[a])}else for(let a in e)s=remove_index(e[a],t,r,n,i),s||delete e[a];return s}Index.prototype.searchCache=searchCache;Index.prototype.export=exportIndex;Index.prototype.import=importIndex;apply_async(Index.prototype);function handler(e){e=e.data;const t=self._index,r=e.args,n=e.task;switch(n){case"init":const i=e.options||{},s=e.factory,a=i.encode;i.cache=!1,a&&a.indexOf("function")===0&&(i.encode=Function("return "+a)()),s?(Function("return "+s)()(self),self._index=new self.FlexSearch.Index(i),delete self.FlexSearch):self._index=new Index(i);break;default:const o=e.id,l=t[n].apply(t,r);postMessage(n==="search"?{id:o,msg:l}:{id:o})}}let pid=0;function WorkerIndex(e){if(!(this instanceof WorkerIndex))return new WorkerIndex(e);let t;e?is_function(t=e.encode)&&(e.encode=t.toString()):e={};let r=(self||window)._factory;r&&(r=r.toString());const n=typeof window>"u"&&self.exports,i=this;this.worker=create(r,n,e.worker),this.resolver=create_object(),this.worker&&(n?this.worker.on("message",function(s){i.resolver[s.id](s.msg),delete i.resolver[s.id]}):this.worker.onmessage=function(s){s=s.data,i.resolver[s.id](s.msg),delete i.resolver[s.id]},this.worker.postMessage({task:"init",factory:r,options:e}))}register("add");register("append");register("search");register("update");register("remove");function register(e){WorkerIndex.prototype[e]=WorkerIndex.prototype[e+"Async"]=function(){const t=this,r=[].slice.call(arguments),n=r[r.length-1];let i;is_function(n)&&(i=n,r.splice(r.length-1,1));const s=new Promise(function(a){setTimeout(function(){t.resolver[++pid]=a,t.worker.postMessage({task:e,id:pid,args:r})})});return i?(s.then(i),this):s}}function create(factory,is_node_js,worker_path){let worker;try{worker=is_node_js?eval('new (require("worker_threads")["Worker"])(__dirname + "/node/node.js")'):factory?new Worker(URL.createObjectURL(new Blob(["onmessage="+handler.toString()],{type:"text/javascript"}))):new Worker(is_string(worker_path)?worker_path:"worker/worker.js",{type:"module"})}catch(e){}return worker}function Document(e){if(!(this instanceof Document))return new Document(e);const t=e.document||e.doc||e;let r;this.tree=[],this.field=[],this.marker=[],this.register=create_object(),this.key=(r=t.key||t.id)&&parse_tree(r,this.marker)||"id",this.fastupdate=parse_option(e.fastupdate,!0),this.storetree=(r=t.store)&&r!==!0&&[],this.store=r&&create_object(),this.tag=(r=t.tag)&&parse_tree(r,this.marker),this.tagindex=r&&create_object(),this.cache=(r=e.cache)&&new CacheClass(r),e.cache=!1,this.worker=e.worker,this.async=!1,this.index=parse_descriptor.call(this,e,t)}function parse_descriptor(e,t){const r=create_object();let n=t.index||t.field||t;is_string(n)&&(n=[n]);for(let i=0,s,a;i<n.length;i++)s=n[i],is_string(s)||(a=s,s=s.field),a=is_object(a)?Object.assign({},e,a):e,this.worker&&(r[s]=new WorkerIndex(a),r[s].worker||(this.worker=!1)),this.worker||(r[s]=new Index(a,this.register)),this.tree[i]=parse_tree(s,this.marker),this.field[i]=s;if(this.storetree){let i=t.store;is_string(i)&&(i=[i]);for(let s=0;s<i.length;s++)this.storetree[s]=parse_tree(i[s],this.marker)}return r}function parse_tree(e,t){const r=e.split(":");let n=0;for(let i=0;i<r.length;i++)e=r[i],0<=e.indexOf("[]")&&(e=e.substring(0,e.length-2),e&&(t[n]=!0)),e&&(r[n++]=e);return n<r.length&&(r.length=n),1<n?r:r[0]}function parse_simple(e,t){if(is_string(t))e=e[t];else for(let r=0;e&&r<t.length;r++)e=e[t[r]];return e}function store_value(e,t,r,n,i){if(e=e[i],n===r.length-1)t[i]=e;else if(e)if(is_array(e)){t=t[i]=Array(e.length);for(let s=0;s<e.length;s++)store_value(e,t,r,n,s)}else t=t[i]||(t[i]=create_object()),i=r[++n],store_value(e,t,r,n,i)}function add_index(e,t,r,n,i,s,a,o){if(e=e[a],e)if(n===t.length-1){if(is_array(e)){if(r[n]){for(let l=0;l<e.length;l++)i.add(s,e[l],!0,!0);return}e=e.join(" ")}i.add(s,e,o,!0)}else if(is_array(e))for(let l=0;l<e.length;l++)add_index(e,t,r,n,i,s,l,o);else a=t[++n],add_index(e,t,r,n,i,s,a,o)}Document.prototype.add=function(e,t,r){if(is_object(e)&&(t=e,e=parse_simple(t,this.key)),t&&(e||e===0)){if(!r&&this.register[e])return this.update(e,t);for(let n=0,i,s;n<this.field.length;n++)s=this.field[n],i=this.tree[n],is_string(i)&&(i=[i]),add_index(t,i,this.marker,0,this.index[s],e,i[0],r);if(this.tag){let n=parse_simple(t,this.tag),i=create_object();is_string(n)&&(n=[n]);for(let s=0,a,o;s<n.length;s++)if(a=n[s],!i[a]&&(i[a]=1,o=this.tagindex[a]||(this.tagindex[a]=[]),(!r||!o.includes(e))&&(o[o.length]=e,this.fastupdate))){const l=this.register[e]||(this.register[e]=[]);l[l.length]=o}}if(this.store&&(!r||!this.store[e])){let n;if(this.storetree){n=create_object();for(let i=0,s;i<this.storetree.length;i++)s=this.storetree[i],is_string(s)?n[s]=t[s]:store_value(t,n,s,0,s[0])}this.store[e]=n||t}}return this};Document.prototype.append=function(e,t){return this.add(e,t,!0)};Document.prototype.update=function(e,t){return this.remove(e).add(e,t)};Document.prototype.remove=function(e){if(is_object(e)&&(e=parse_simple(e,this.key)),this.register[e]){for(let t=0;t<this.field.length&&(this.index[this.field[t]].remove(e,!this.worker),!this.fastupdate);t++);if(this.tag&&!this.fastupdate)for(let t in this.tagindex){const r=this.tagindex[t],n=r.indexOf(e);n!==-1&&(1<r.length?r.splice(n,1):delete this.tagindex[t])}this.store&&delete this.store[e],delete this.register[e]}return this};Document.prototype.search=function(e,t,r,n){r||(!t&&is_object(e)?(r=e,e=""):is_object(t)&&(r=t,t=0));let i=[],s=[],a,o,l,u,d,p,c=0;if(r)if(is_array(r))l=r,r=null;else{if(e=r.query||e,a=r.pluck,l=a||r.index||r.field,u=r.tag,o=this.store&&r.enrich,d=r.bool==="and",t=r.limit||t||100,p=r.offset||0,u&&(is_string(u)&&(u=[u]),!e)){for(let f=0,g;f<u.length;f++)g=get_tag.call(this,u[f],t,p,o),g&&(i[i.length]=g,c++);return c?i:[]}is_string(l)&&(l=[l])}l||(l=this.field),d=d&&(1<l.length||u&&1<u.length);const h=!n&&(this.worker||this.async)&&[];for(let f=0,g,m,x;f<l.length;f++){let _;if(m=l[f],is_string(m)||(_=m,m=_.field,e=_.query||e,t=_.limit||t,o=_.enrich||o),h){h[f]=this.index[m].searchAsync(e,t,_||r);continue}else n?g=n[f]:g=this.index[m].search(e,t,_||r);if(x=g&&g.length,u&&x){const F=[];let b=0;d&&(F[0]=[g]);for(let v=0,I,y;v<u.length;v++)I=u[v],y=this.tagindex[I],x=y&&y.length,x&&(b++,F[F.length]=d?[y]:y);b&&(d?g=intersect(F,t||100,p||0):g=intersect_union(g,F),x=g.length)}if(x)s[c]=m,i[c++]=g;else if(d)return[]}if(h){const f=this;return new Promise(function(g){Promise.all(h).then(function(m){g(f.search(e,t,r,m))})})}if(!c)return[];if(a&&(!o||!this.store))return i[0];for(let f=0,g;f<s.length;f++){if(g=i[f],g.length&&o&&(g=apply_enrich.call(this,g)),a)return g;i[f]={field:s[f],result:g}}return i};function get_tag(e,t,r){let n=this.tagindex[e];n&&n.length-r}function apply_enrich(e){const t=Array(e.length);for(let r=0,n;r<e.length;r++)n=e[r],t[r]={id:n,doc:this.store[n]};return t}Document.prototype.contain=function(e){return!!this.register[e]};Document.prototype.get=function(e){return this.store[e]};Document.prototype.set=function(e,t){return this.store[e]=t,this};Document.prototype.searchCache=searchCache;Document.prototype.export=exportDocument;Document.prototype.import=importDocument;apply_async(Document.prototype);const useStore=defineStore("Search",()=>{const e=ref({debug:!0,deepLinked:!1,url:"news",loaded:!1,data:void 0,searchIndex:void 0,options:{minQueryLength:3,documentIndex:["title","brand","category","description"]},pagination:{page:1,perPage:10,max:1},query:void 0,result:void 0}),t=async()=>new Promise(c=>e.value.loaded?c(e.value.data):e.value.debug?c(__vitePreload(()=>import("./huge-BgtBmg1_.js"),[]).then(h=>h.default)):window.__SEARCH?c(window.__SEARCH):e.value.url?c(api.get(e.value.url).then(({data:h})=>h)):c([])).then(c=>(e.value.loaded=!0,e.value.data=c||void 0,c)).then(r),r=async()=>new Promise(c=>{if(e.value.searchIndex){c(e.value.searchIndex);return}const h=new Document({preset:"match",async:!0,cache:!0,tokenize:"full",charset:"latin:advanced",resolution:5,context:{resolution:5,depth:2,bidirectional:!0,minlength:3},document:{id:"id",index:e.value.options.documentIndex,store:!0,enrich:!0,suggest:!0}});setTimeout(()=>{each(e.value.data,f=>{h.add(f)}),e.value.searchIndex=h,n(),c(h)},100)}),n=()=>{const c=useRouter().currentRoute.value.query;c.page&&(e.value.pagination.page=parseInt(c.page,10)||1),delete c.page,c.q&&(e.value.query=c.q,s(c.q))},i=()=>{if(!e.value.deepLinked)return;const c={};e.value.query?c.q=e.value.query:delete c.q,e.value.pagination.page?c.page=e.value.pagination.page:delete c.page,useRouter().replace({query:c})},s=async(c="",h)=>{const f=e.value.searchIndex||await t;if(!c)return a();const g=await f.search(c,1e9,{limit:1e9,enrich:!0,bool:"or",...h});if(!g||g.length==0)return a();const m=uniqBy$1(flatMap$1(g,x=>flatMapDeep$1(x.result,"doc")),"id");return e.value.query=c,e.value.result=m},a=()=>(e.value.query=void 0,e.value.pagination.page=1,e.value.pagination.max=1,e.value.result=void 0),o=async(c="",h)=>{const g=await(e.value.searchIndex||await t).search(c,5,{limit:5,suggest:!0,enrich:!0,bool:"or",...h});if(!g||g.length==0)return;let m=[];return each(g,x=>{const F=flatMapDeep$1(x.result,"doc.title");m=concat$2(m,F)}),m=slice$1(uniq$1(m),0,5),m},l=c=>{e.value.pagination.page=c},u=()=>{e.value.pagination.page-1===0?e.value.pagination.page=1:e.value.pagination.page=e.value.pagination.page-1},d=()=>{e.value.pagination.page+1>e.value.pagination.max?e.value.pagination.page=e.value.pagination.max:e.value.pagination.page=e.value.pagination.page+1},p=computed(()=>{const c=e.value.result;if(!c){i();return}const{page:h,perPage:f}=e.value.pagination,m=(h-1)*f+f,x=slice$1(c,0,m);return e.value.pagination.max=Math.ceil(c.length/e.value.pagination.perPage),i(),x});return{state:e,init:t,search:s,clear:a,autocomplete:o,setPagination:l,prevPagination:u,nextPagination:d,options:computed(()=>e.value.options),paginated:p,pagination:computed(()=>e.value.pagination)}}),store=useStore(pinia),UiSearch=defineComponent({name:"UiSearch",components:{KoddeinField,KoddeinForm},props:{full:{type:Boolean,default:!0},autocomplete:{type:Boolean,default:!0}},setup(e){const{t}=useI18n(),r=store$1.locale,{options:n}=toRefs(store.state),i=useRoute(),s=useRouter$1(),a=templateRef("suggestionElem",null),o=reactive({model:createFormModel({search:{type:"text",validations:[FORM_RULES.MIN],min:3,required:!1}}),formState:FORM_STATUS.PRISTINE,search:{busy:!1,error:!1,autocomplete:void 0}});onClickOutside(a,()=>{o.search.autocomplete=void 0});const{ready:l}=useFlow({async load(){return o.model.search.value=i.query.q,await store.init()}}),u=async()=>e.full?await store.search(o.model.search.value).then(h=>{o.search.busy=!1,o.search.error=!h,o.search.autocomplete=void 0}):s.push({path:`/${r.name}`,query:{q:o.model.search.value}}),d=async()=>{if(o.model.search.error="",o.search.autocomplete=void 0,e.autocomplete&&!o.search.busy&&o.model.search.value&&o.model.search.value.length>=n.value.minQueryLength)return await store.autocomplete(o.model.search.value).then(h=>{o.search.busy=!1,o.search.autocomplete=h})},p=h=>{o.model.search.value=h,u()},c=()=>{store.nextPagination()};return{t,...toRefs(o),ready:l,submit:u,suggestion:d,searchSuggestion:p,nextPage:c,pagination:computed(()=>store.pagination),result:computed(()=>store.paginated),Icon}}}),_hoisted_1=["textContent"],_hoisted_2={class:"content"},_hoisted_3={key:0,ref:"suggestionElem",class:"suggestion"},_hoisted_4=["onClick","textContent"],_hoisted_5={key:0,class:"result"},_hoisted_6=["textContent"],_hoisted_7={class:"label"},_hoisted_8={key:0,class:"pagination"},_hoisted_9={key:0,class:"result"},_hoisted_10=["textContent"];function _sfc_render(e,t,r,n,i,s){const a=resolveComponent("KoddeinField"),o=resolveComponent("KoddeinForm"),l=resolveComponent("ui-button");return e.ready?(openBlock(),createElementBlock("section",{key:0,class:normalizeClass(`UiSearch ${e.full?"-full":""}`)},[e.full?(openBlock(),createElementBlock("h2",{key:0,class:"title",textContent:toDisplayString(e.t("LABELS.search.label"))},null,8,_hoisted_1)):createCommentVNode("",!0),e.model?(openBlock(),createBlock(o,{key:"searchForm",model:e.model,labels:{submit:" "},icons:{submit:e.Icon},recaptcha:!1,flash:!1,reset:!1,class:"form","submit-icon":"","on-send":e.submit,onUpdate:t[2]||(t[2]=u=>e.model=u),onStatus:t[3]||(t[3]=u=>e.formState=u)},{default:withCtx(()=>[createVNode(a,mergeProps({modelValue:e.model.search.value,"onUpdate:modelValue":t[0]||(t[0]=u=>e.model.search.value=u)},e.model.search,{"onUpdate:modelValue":e.suggestion,onFocus:t[1]||(t[1]=u=>e.formState="PRISTINE")}),null,16,["modelValue","onUpdate:modelValue"])]),_:1},8,["model","icons","on-send"])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_2,[createVNode(Transition,{name:"fade"},{default:withCtx(()=>[e.search.autocomplete?(openBlock(),createElementBlock("div",_hoisted_3,[createBaseVNode("ul",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.search.autocomplete,u=>(openBlock(),createElementBlock("li",{key:`result-suggestion-${u}`,class:"suggestion-entry",onClick:d=>e.searchSuggestion(u),textContent:toDisplayString(u)},null,8,_hoisted_4))),128))])],512)):createCommentVNode("",!0)]),_:1}),createVNode(Transition,{name:"fade"},{default:withCtx(()=>[e.full&&e.result&&e.result.length>0?(openBlock(),createElementBlock("div",_hoisted_5,[createBaseVNode("h3",{class:"subtitle",textContent:toDisplayString(e.t("LABELS.search.result",e.result.length))},null,8,_hoisted_6),createVNode(TransitionGroup,{class:"entries",name:"list",tag:"ul"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.result,u=>(openBlock(),createElementBlock("li",{key:`result-search-${u.id}`,class:"entry"},[t[4]||(t[4]=createBaseVNode("span",{class:"border -top"},null,-1)),createBaseVNode("span",_hoisted_7,toDisplayString(u.title),1),t[5]||(t[5]=createBaseVNode("span",{class:"border -bottom"},null,-1))]))),128))]),_:1}),e.pagination&&e.pagination.page<e.pagination.max?(openBlock(),createElementBlock("div",_hoisted_8,[createVNode(l,{label:e.t("LABELS.search.load_more"),theme:"primary",onClick:e.nextPage},null,8,["label","onClick"])])):createCommentVNode("",!0)])):createCommentVNode("",!0)]),_:1}),createVNode(Transition,{name:"fade"},{default:withCtx(()=>[e.full&&e.search.error?(openBlock(),createElementBlock("div",_hoisted_9,[createBaseVNode("p",{class:"error",textContent:toDisplayString(e.t("LABELS.search.error"))},null,8,_hoisted_10)])):createCommentVNode("",!0)]),_:1})])],2)):createCommentVNode("",!0)}const index=_export_sfc(UiSearch,[["render",_sfc_render]]),index$1=Object.freeze(Object.defineProperty({__proto__:null,default:index},Symbol.toStringTag,{value:"Module"}));export{FORM_STATUS as F,MASK_MODELS as M,index$1 as a,isEqual$1 as i};
//# sourceMappingURL=index-nf84ZHYf.js.map
