import{r as I,b9 as W,p as h,l as v,u as D,X as C,W as x,c as q,a5 as z,a6 as X,a as B}from"./vendor-D1O0VZ-0.js";import{C as P,m as s,D as K,s as m,c as S,g as Y,j as E,F as Q,G as Z}from"./app-B-a8PNc9.js";import{a as tt}from"./index-BLjVU2Wl.js";const a={DEFAULT:0,LOADED:1,INIT:2,INIT_UI:3,READY:4};function nt(J={}){var H;const e={autoSetReady:!0,...J};function N(...t){!e.debug||Z}const i=I(a.DEFAULT);let R={};const c=I(((H=e.data)==null?void 0:H.call(e))??{});function M(){return C(c)}const O=I({});function V(){return C(O.value)}const l=I({});function g(){return C((l==null?void 0:l.value)||void 0)}const w=I();function y(){return C((w==null?void 0:w.value)||void 0)}function U(t=!0){if(!t){i.value=a.DEFAULT;return}if(i.value===a.READY){setTimeout(()=>{Y.UPDATE(g(),y()),E.setPageReady(),m.refreshScroll(),m.scrollTop(),setTimeout(()=>{window.prerenderReady=!0},500)},500);return}const n=s?a.INIT_UI:a.INIT;N("setReady -",{motion:s,state:i.value,requiredState:n}),d(n).then(()=>{Y.UPDATE(g(),y()),i.value=a.READY,E.setPageReady(),m.refreshScroll(),setTimeout(()=>{window.prerenderReady=!0},500)})}function d(t){return new Promise(n=>{const _=x(i,f=>{N("waitForState",f,t),f>=t&&setTimeout(()=>{n(!0),_()},14)},{immediate:!0,flush:"post"})})}async function $(){return new Promise(t=>{var u,o,A,p,F,T,b,j,G,L;return typeof e.load=="function"?t(e.load(!E.firstPageReady)):window.__PAGE&&!E.firstPageReady&&!Q("VITE_MOC_API")&&!((u=e.api)!=null&&u.moc)?((o=e.api)!=null&&o.cache&&((A=e.api)!=null&&A.url)&&(window.__CACHE||(window.__CACHE={}),window.__CACHE[e.api.url]=JSON.stringify(((F=(p=e.api)==null?void 0:p.format)==null?void 0:F.call(p,{data:window.__PAGE}))??window.__PAGE)),t(((b=(T=e.api)==null?void 0:T.format)==null?void 0:b.call(T,{data:window.__PAGE}))??window.__PAGE)):((j=e.api)==null?void 0:j.cache)&&((G=e.api)==null?void 0:G.url)&&window.__CACHE&&window.__CACHE[e.api.url]&&window.__CACHE&&((L=e.api)!=null&&L.url)&&window.__CACHE[e.api.url]?t(JSON.parse(window.__CACHE[e.api.url])):e.api?t(tt.get(e.api.url,{},{showErrorMessage:!1,...e.api})):t({})}).then(t=>{var _,f;function n(r){return e.data?B({},e.data(),r??{}):r}if(typeof t=="object"&&t)if(t.data){t.meta&&(O.value=t.meta);const{seo:r,translations:u,translation:o,...A}=t.data;r&&(l.value=r),(u||o)&&(w.value=u||o),c.value=n(A)}else{const{seo:r,translations:u,translation:o}=t;r&&(l.value=r),(u||o)&&(w.value=u||o),c.value=n(t)}return i.value=a.LOADED,(_=e.api)!=null&&_.cache&&((f=e.api)!=null&&f.url)&&(window.__CACHE||(window.__CACHE={}),window.__CACHE[e.api.url]=JSON.stringify(t)),t}).catch(()=>{E.setIs404()})}async function k(){return new Promise(t=>e.ui?Promise.all(q(e.ui,n=>n())).then(n=>z(X(e.ui),n)).then(t):t(void 0)).then(t=>(t&&typeof t=="object"&&(R=t),t))}return Promise.all([$(),new Promise(t=>{if(P)return t(!0);W(()=>t(!0))})]).then(t=>(h(()=>{i.value=a.INIT}),t)),s&&Promise.all([k(),d(a.INIT),new Promise(t=>W(()=>t(!0)))]).then(t=>(h(()=>{i.value=a.INIT_UI,h(()=>{K.updateCursor(),m.refreshScroll(),setTimeout(m.updateScroll,500)})}),t)),e.autoSetReady&&U(),{loaded:v(()=>i.value>=a.LOADED),ready:v(()=>i.value>=a.READY),readyToRender:v(()=>i.value>=(s?a.INIT_UI:a.INIT)),getData:M,getMeta:V,getSEO:g,getTranslation:y,setReady:U,waitForState:d,state:i,onloaded:async function(t){return await d(a.INIT),t({client:S,server:P,motion:s,data:D(c)})},onInit:async function(t){return await d(a.INIT),t({client:S,server:P,motion:s,data:D(c)})},onInitUi:async function(t){if(s)return await d(a.INIT_UI),t({client:S,server:P,motion:s,data:D(c),ui:R})}}}export{nt as u};
//# sourceMappingURL=page-CzMb_JX1.js.map
