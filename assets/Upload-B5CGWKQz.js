import{d as b,aP as z,aW as M,p as V,bO as k,W as w,al as B,ay as E,q as v,o as f,Z as c,aU as a,b1 as L,aT as C,_ as h,a0 as S,aX as T,a1 as U,a2 as y,a$ as $,b2 as H,g as D}from"./vendor-Dk7UPmZi.js";import{i as A}from"./index-DRkeQmIB.js";import{_ as N}from"./app-i-894-h8.js";import"./@debug-lodash-BIjirobg.js";import"./index-CujeyXVt.js";import"./LocalStorage-YPpH-X0R.js";const q=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29.29 30.74"><path d="M14.66,0V30" fill="none" stroke="currentColor" vector-effect="non-scaling-stroke"/><path d="M.35,15.71l14.29,14.29,14.29-14.29" fill="none" stroke="currentColor" vector-effect="non-scaling-stroke"/><path d="M29.18,30.24H.11" fill="none" stroke="currentColor" vector-effect="non-scaling-stroke"/></svg>
`,O='<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 19.8 18.8"><path d="M17 6.1L15 .5c-.2-.4-.6-.6-1-.5L.5 5c-.4.1-.6.5-.5 1l2.1 5.9V8.7c0-1.4 1.1-2.6 2.5-2.6h3.6l4.2-3 2.5 3H17zm2 1.8H4.7c-.4 0-.7.4-.7.8V18c0 .4.3.8.8.8H19c.4 0 .8-.4.8-.8V8.7c0-.4-.3-.8-.8-.8zm-1 8.9H6.1v-1.7l1.8-4.3 2.7 3.4 2.6-2.6 3.3-1.2 1.4 3.2v3.2h.1z" fill-rule="evenodd" clip-rule="evenodd"/></svg>',P='<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 16.6 16.6"><path d="M8.3 0C3.7 0 0 3.7 0 8.3s3.7 8.3 8.3 8.3 8.3-3.7 8.3-8.3S12.9 0 8.3 0zM6.6 12.5L2.5 8.3l1.2-1.2 3 3L13 3.8 14.1 5l-7.5 7.5z" fill-rule="evenodd" clip-rule="evenodd"/></svg>',R=b({name:"KoddeinFormUpload",props:{id:{type:String,required:!0},value:{type:Array,default:()=>[]},accept:{type:Array,default:()=>[]},size:{type:Number,default:void 0}},emits:["inputChange","onFocus","onBlur"],setup(e,{emit:n}){const{t:s}=z(),o=M({el:void 0,files:void 0,fileform:void 0,dragAndDropCapable:!1,internalValue:[],errorSize:!1});V(()=>{o.fileform&&(o.dragAndDropCapable=W(),o.dragAndDropCapable&&(["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(t=>{var l;(l=o.fileform)==null||l.addEventListener(t,u=>{u.preventDefault(),u.stopPropagation()},!1)}),o.fileform.addEventListener("drop",r)))}),k(()=>{o.dragAndDropCapable&&o.fileform&&o.fileform.removeEventListener("drop",r)}),w(()=>e.value,t=>{t&&t.length&&(o.internalValue=t)},{immediate:!0}),w(()=>o.internalValue,t=>{A(t,e.value)||n("inputChange",t)},{deep:!0});const d=()=>{var t;(t=o.files)==null||t.click()},p=t=>{o.internalValue&&o.internalValue[t]&&o.internalValue.splice(t,1)},r=t=>{var l;if(o.files){const u=((l=t==null?void 0:t.dataTransfer)==null?void 0:l.files)||o.files.files;B(u,g=>{const F=g.size/1e3/1e3;e.size&&F<=e.size?o.internalValue.push(g):e.size&&(o.errorSize=!0,setTimeout(()=>{o.errorSize=!1},5e3))}),o.files.value=""}},i=()=>{n("onFocus")},m=()=>{n("onBlur")};return{t:s,...E(o),isFocus:i,isBlur:m,handleFilesUpload:r,addFiles:d,removeFile:p,Upload:q,Media:O,Success:P,beforeEnter:I,enter:K,leave:j,enterProgress:x}}}),W=()=>{const e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window},I=e=>{v.set(e,{opacity:0,y:30})},K=(e,n)=>{v.to(e,{duration:.3,opacity:1,y:0,onComplete:n,ease:"power1.out"})},j=(e,n)=>{v.to(e,{duration:.3,opacity:0,y:-30,onComplete:n,ease:"power1.in"})},x=(e,n)=>{const s=e.querySelector(".value"),o=e.parentNode,d=Math.random()*600+1e3,p=v.to(e.querySelector(".current"),{duration:d/1e3,width:"100%",ease:"power1.inOut",onUpdate:()=>{s&&(s.innerHTML=`${Math.floor(p.progress()*100)}%`)},onComplete:()=>{o&&o.setAttribute("ready","true"),n()}})},G={ref:"el",class:"koddein-field-upload"},X=["id","accept"],Z=["innerHTML"],J=["innerHTML"],Q=["data-key"],Y=["onClick"],_=["textContent"];function ee(e,n,s,o,d,p){return f(),c("div",G,[a("input",{id:`field-${e.id}`,ref:"files",accept:e.accept.join(", "),type:"file",class:"input file",multiple:"",onChange:n[0]||(n[0]=(...r)=>e.handleFilesUpload&&e.handleFilesUpload(...r)),onFocus:n[1]||(n[1]=(...r)=>e.isFocus&&e.isFocus(...r)),onBlur:n[2]||(n[2]=(...r)=>e.isBlur&&e.isBlur(...r))},null,40,X),a("button",{ref:"fileform",type:"button",class:"dragndrop",tabindex:"-1",onClick:n[3]||(n[3]=L((...r)=>e.addFiles&&e.addFiles(...r),["prevent"]))},[a("i",{class:"icon -upload",innerHTML:e.Upload},null,8,Z),a("span",{innerHTML:e.t("FORMS.upload.drop")},null,8,J)],512),C(H,{tag:"div",class:"files",onCss:r=>!1,onEnter:e.enter,onLeave:e.leave,onBeforeEnter:e.beforeEnter},{default:h(()=>[(f(!0),c(S,null,T(e.internalValue,(r,i)=>(f(),c("div",{key:`file-${i}`,class:"file-item","data-key":i},[U(y(r.name)+" ",1),a("span",{class:"remove-file",onClick:m=>e.removeFile(i)},null,8,Y),C($,{appear:"",onCss:m=>!1,onEnter:e.enterProgress},{default:h(()=>n[4]||(n[4]=[a("div",{class:"progress"},[a("span",{class:"bar"},[a("span",{style:{width:"0%"},class:"current"})]),a("span",{class:"value",textContent:"0%"})],-1)])),_:1},8,["onEnter"])],8,Q))),128))]),_:1},8,["onEnter","onLeave","onBeforeEnter"]),e.errorSize?(f(),c("span",{key:0,class:"error",textContent:y(e.t("FORMS.upload.size",{size:e.size}))},null,8,_)):D("",!0)],512)}const ie=N(R,[["render",ee],["__scopeId","data-v-d30f0aed"]]);export{ie as default};
//# sourceMappingURL=Upload-B5CGWKQz.js.map
